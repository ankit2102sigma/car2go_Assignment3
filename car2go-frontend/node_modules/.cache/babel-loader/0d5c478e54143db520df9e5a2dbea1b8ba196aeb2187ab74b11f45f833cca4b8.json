{"ast":null,"code":"import CryptoJS from 'crypto-js';\n\n// Generate a random salt value\nconst salt = CryptoJS.lib.WordArray.random(16).toString();\n\n/**\n * Salts a value by concatenating it with the salt value\n * and then hashing it with a strong hash function.\n *\n * @param {string} value - The value to salt.\n * @returns {string} The salted and hashed value.\n */\nexport function saltValue(value) {\n  const valueToHash = salt + value;\n  return CryptoJS.SHA3(valueToHash).toString();\n}\n\n/**\n * Desalts a value by hashing the salt and the original value,\n * and then comparing the result with the hashed value.\n * If they match, returns the original value.\n *\n * @param {string} hashedValue - The hashed value to desalt.\n * @returns {string|null} The original value, or null if the hashed value is incorrect.\n */\nexport function desaltValue(hashedValue) {\n  const valueToCheck = salt + hashedValue.substring(salt.length);\n  const hashedValueToCheck = CryptoJS.SHA3(valueToCheck).toString();\n  if (hashedValueToCheck === hashedValue) {\n    return valueToCheck.substring(salt.length);\n  } else {\n    return null;\n  }\n}","map":{"version":3,"names":["CryptoJS","salt","lib","WordArray","random","toString","saltValue","value","valueToHash","SHA3","desaltValue","hashedValue","valueToCheck","substring","length","hashedValueToCheck"],"sources":["/var/www/html/Car2Go/car2go-frontend/src/salting.js"],"sourcesContent":["import CryptoJS from 'crypto-js';\n\n// Generate a random salt value\nconst salt = CryptoJS.lib.WordArray.random(16).toString();\n\n/**\n * Salts a value by concatenating it with the salt value\n * and then hashing it with a strong hash function.\n *\n * @param {string} value - The value to salt.\n * @returns {string} The salted and hashed value.\n */\nexport function saltValue(value) {\n  const valueToHash = salt + value;\n  return CryptoJS.SHA3(valueToHash).toString();\n}\n\n/**\n * Desalts a value by hashing the salt and the original value,\n * and then comparing the result with the hashed value.\n * If they match, returns the original value.\n *\n * @param {string} hashedValue - The hashed value to desalt.\n * @returns {string|null} The original value, or null if the hashed value is incorrect.\n */\nexport function desaltValue(hashedValue) {\n  const valueToCheck = salt + hashedValue.substring(salt.length);\n  const hashedValueToCheck = CryptoJS.SHA3(valueToCheck).toString();\n\n  if (hashedValueToCheck === hashedValue) {\n    return valueToCheck.substring(salt.length);\n  } else {\n    return null;\n  }\n}\n"],"mappings":"AAAA,OAAOA,QAAQ,MAAM,WAAW;;AAEhC;AACA,MAAMC,IAAI,GAAGD,QAAQ,CAACE,GAAG,CAACC,SAAS,CAACC,MAAM,CAAC,EAAE,CAAC,CAACC,QAAQ,EAAE;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,SAASA,CAACC,KAAK,EAAE;EAC/B,MAAMC,WAAW,GAAGP,IAAI,GAAGM,KAAK;EAChC,OAAOP,QAAQ,CAACS,IAAI,CAACD,WAAW,CAAC,CAACH,QAAQ,EAAE;AAC9C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASK,WAAWA,CAACC,WAAW,EAAE;EACvC,MAAMC,YAAY,GAAGX,IAAI,GAAGU,WAAW,CAACE,SAAS,CAACZ,IAAI,CAACa,MAAM,CAAC;EAC9D,MAAMC,kBAAkB,GAAGf,QAAQ,CAACS,IAAI,CAACG,YAAY,CAAC,CAACP,QAAQ,EAAE;EAEjE,IAAIU,kBAAkB,KAAKJ,WAAW,EAAE;IACtC,OAAOC,YAAY,CAACC,SAAS,CAACZ,IAAI,CAACa,MAAM,CAAC;EAC5C,CAAC,MAAM;IACL,OAAO,IAAI;EACb;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}