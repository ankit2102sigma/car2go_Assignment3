{"ast":null,"code":"import CryptoJS from 'crypto-js';\nexport function saltAndHashId(id) {\n  const salt = CryptoJS.lib.WordArray.random(16).toString();\n  const hash = CryptoJS.SHA256(id + salt).toString();\n  return salt + hash;\n}\nexport function desaltId(saltedId, id) {\n  const salt = saltedId.substr(0, 32);\n  const hash = saltedId.substr(32);\n  const computedHash = CryptoJS.SHA256(id + salt).toString();\n  if (computedHash === hash) {\n    return id;\n  } else {\n    return null; // or throw an error\n  }\n}\n\n// import CryptoJS from 'crypto-js';\n\n// export function desaltId(saltedId) {\n//   const salt = saltedId.substr(0, 32);\n//   const hash = saltedId.substr(32);\n//   const id = CryptoJS.SHA256(hash + salt).toString();\n//   return id;\n// }","map":{"version":3,"names":["CryptoJS","saltAndHashId","id","salt","lib","WordArray","random","toString","hash","SHA256","desaltId","saltedId","substr","computedHash"],"sources":["/var/www/html/Car2Go/car2go-frontend/src/salting.js"],"sourcesContent":["import CryptoJS from 'crypto-js';\n\nexport function saltAndHashId(id) {\n  const salt = CryptoJS.lib.WordArray.random(16).toString();\n  const hash = CryptoJS.SHA256(id + salt).toString();\n  return salt + hash;\n}\n\nexport function desaltId(saltedId, id) {\n  const salt = saltedId.substr(0, 32);\n  const hash = saltedId.substr(32);\n  const computedHash = CryptoJS.SHA256(id + salt).toString();\n  if (computedHash === hash) {\n    return id;\n  } else {\n    return null; // or throw an error\n  }\n}\n\n// import CryptoJS from 'crypto-js';\n\n// export function desaltId(saltedId) {\n//   const salt = saltedId.substr(0, 32);\n//   const hash = saltedId.substr(32);\n//   const id = CryptoJS.SHA256(hash + salt).toString();\n//   return id;\n// }\n\n\n\n"],"mappings":"AAAA,OAAOA,QAAQ,MAAM,WAAW;AAEhC,OAAO,SAASC,aAAaA,CAACC,EAAE,EAAE;EAChC,MAAMC,IAAI,GAAGH,QAAQ,CAACI,GAAG,CAACC,SAAS,CAACC,MAAM,CAAC,EAAE,CAAC,CAACC,QAAQ,EAAE;EACzD,MAAMC,IAAI,GAAGR,QAAQ,CAACS,MAAM,CAACP,EAAE,GAAGC,IAAI,CAAC,CAACI,QAAQ,EAAE;EAClD,OAAOJ,IAAI,GAAGK,IAAI;AACpB;AAEA,OAAO,SAASE,QAAQA,CAACC,QAAQ,EAAET,EAAE,EAAE;EACrC,MAAMC,IAAI,GAAGQ,QAAQ,CAACC,MAAM,CAAC,CAAC,EAAE,EAAE,CAAC;EACnC,MAAMJ,IAAI,GAAGG,QAAQ,CAACC,MAAM,CAAC,EAAE,CAAC;EAChC,MAAMC,YAAY,GAAGb,QAAQ,CAACS,MAAM,CAACP,EAAE,GAAGC,IAAI,CAAC,CAACI,QAAQ,EAAE;EAC1D,IAAIM,YAAY,KAAKL,IAAI,EAAE;IACzB,OAAON,EAAE;EACX,CAAC,MAAM;IACL,OAAO,IAAI,CAAC,CAAC;EACf;AACF;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}