{"ast":null,"code":"import CryptoJS from 'crypto-js';\nexport function saltAndHashId(id) {\n  const salt = CryptoJS.lib.WordArray.random(16);\n  const hash = CryptoJS.SHA256(id + salt).toString(CryptoJS.enc.Hex);\n  return salt.toString(CryptoJS.enc.Hex) + hash;\n}\nexport function desaltId(saltedId) {\n  const salt = saltedId.substr(0, 16);\n  const hash = saltedId.substr(16);\n  const computedHash = CryptoJS.SHA256(salt + hash).toString();\n  if (computedHash === hash) {\n    const id = CryptoJS.enc.Utf8.stringify(CryptoJS.enc.Hex.parse(hash)).slice(salt.length);\n    return id;\n  } else {\n    return null; // or throw an error\n  }\n}","map":{"version":3,"names":["CryptoJS","saltAndHashId","id","salt","lib","WordArray","random","hash","SHA256","toString","enc","Hex","desaltId","saltedId","substr","computedHash","Utf8","stringify","parse","slice","length"],"sources":["/var/www/html/Car2Go/car2go-frontend/src/salting.js"],"sourcesContent":["import CryptoJS from 'crypto-js';\n\n\nexport function saltAndHashId(id) {\n  const salt = CryptoJS.lib.WordArray.random(16);\n  const hash = CryptoJS.SHA256(id + salt).toString(CryptoJS.enc.Hex);\n  return salt.toString(CryptoJS.enc.Hex) + hash;\n}\nexport function desaltId(saltedId) {\n  const salt = saltedId.substr(0, 16);\n  const hash = saltedId.substr(16);\n  const computedHash = CryptoJS.SHA256(salt + hash).toString();\n  if (computedHash === hash) {\n    const id = CryptoJS.enc.Utf8.stringify(CryptoJS.enc.Hex.parse(hash)).slice(salt.length);\n    return id;\n  } else {\n    return null; // or throw an error\n  }\n}"],"mappings":"AAAA,OAAOA,QAAQ,MAAM,WAAW;AAGhC,OAAO,SAASC,aAAaA,CAACC,EAAE,EAAE;EAChC,MAAMC,IAAI,GAAGH,QAAQ,CAACI,GAAG,CAACC,SAAS,CAACC,MAAM,CAAC,EAAE,CAAC;EAC9C,MAAMC,IAAI,GAAGP,QAAQ,CAACQ,MAAM,CAACN,EAAE,GAAGC,IAAI,CAAC,CAACM,QAAQ,CAACT,QAAQ,CAACU,GAAG,CAACC,GAAG,CAAC;EAClE,OAAOR,IAAI,CAACM,QAAQ,CAACT,QAAQ,CAACU,GAAG,CAACC,GAAG,CAAC,GAAGJ,IAAI;AAC/C;AACA,OAAO,SAASK,QAAQA,CAACC,QAAQ,EAAE;EACjC,MAAMV,IAAI,GAAGU,QAAQ,CAACC,MAAM,CAAC,CAAC,EAAE,EAAE,CAAC;EACnC,MAAMP,IAAI,GAAGM,QAAQ,CAACC,MAAM,CAAC,EAAE,CAAC;EAChC,MAAMC,YAAY,GAAGf,QAAQ,CAACQ,MAAM,CAACL,IAAI,GAAGI,IAAI,CAAC,CAACE,QAAQ,EAAE;EAC5D,IAAIM,YAAY,KAAKR,IAAI,EAAE;IACzB,MAAML,EAAE,GAAGF,QAAQ,CAACU,GAAG,CAACM,IAAI,CAACC,SAAS,CAACjB,QAAQ,CAACU,GAAG,CAACC,GAAG,CAACO,KAAK,CAACX,IAAI,CAAC,CAAC,CAACY,KAAK,CAAChB,IAAI,CAACiB,MAAM,CAAC;IACvF,OAAOlB,EAAE;EACX,CAAC,MAAM;IACL,OAAO,IAAI,CAAC,CAAC;EACf;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}