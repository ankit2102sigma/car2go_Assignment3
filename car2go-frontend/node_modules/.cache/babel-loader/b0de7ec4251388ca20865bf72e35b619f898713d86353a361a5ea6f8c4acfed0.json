{"ast":null,"code":"import CryptoJS from 'crypto-js';\nconst salt = CryptoJS.lib.WordArray.random(32).toString();\nimport { randomBytes, createHash } from 'crypto';\nexport function saltAndHashId(id) {\n  const salt = randomBytes(16).toString('hex');\n  const hash = createHash('sha256').update(id + salt).digest('hex');\n  return salt + hash;\n}\nexport function desaltId(saltedId) {\n  const salt = saltedId.substr(0, 32);\n  const hash = saltedId.substr(32);\n  return {\n    salt,\n    hash\n  };\n}","map":{"version":3,"names":["CryptoJS","salt","lib","WordArray","random","toString","randomBytes","createHash","saltAndHashId","id","hash","update","digest","desaltId","saltedId","substr"],"sources":["/var/www/html/Car2Go/car2go-frontend/src/salting.js"],"sourcesContent":["import CryptoJS from 'crypto-js'\n\nconst salt = CryptoJS.lib.WordArray.random(32).toString()\n\n\nimport { randomBytes, createHash } from 'crypto';\n\nexport function saltAndHashId(id) {\n  const salt = randomBytes(16).toString('hex');\n  const hash = createHash('sha256').update(id + salt).digest('hex');\n  return salt + hash;\n}\n\nexport function desaltId(saltedId) {\n  const salt = saltedId.substr(0, 32);\n  const hash = saltedId.substr(32);\n  return { salt, hash };\n}\n\n\n\n"],"mappings":"AAAA,OAAOA,QAAQ,MAAM,WAAW;AAEhC,MAAMC,IAAI,GAAGD,QAAQ,CAACE,GAAG,CAACC,SAAS,CAACC,MAAM,CAAC,EAAE,CAAC,CAACC,QAAQ,EAAE;AAGzD,SAASC,WAAW,EAAEC,UAAU,QAAQ,QAAQ;AAEhD,OAAO,SAASC,aAAaA,CAACC,EAAE,EAAE;EAChC,MAAMR,IAAI,GAAGK,WAAW,CAAC,EAAE,CAAC,CAACD,QAAQ,CAAC,KAAK,CAAC;EAC5C,MAAMK,IAAI,GAAGH,UAAU,CAAC,QAAQ,CAAC,CAACI,MAAM,CAACF,EAAE,GAAGR,IAAI,CAAC,CAACW,MAAM,CAAC,KAAK,CAAC;EACjE,OAAOX,IAAI,GAAGS,IAAI;AACpB;AAEA,OAAO,SAASG,QAAQA,CAACC,QAAQ,EAAE;EACjC,MAAMb,IAAI,GAAGa,QAAQ,CAACC,MAAM,CAAC,CAAC,EAAE,EAAE,CAAC;EACnC,MAAML,IAAI,GAAGI,QAAQ,CAACC,MAAM,CAAC,EAAE,CAAC;EAChC,OAAO;IAAEd,IAAI;IAAES;EAAK,CAAC;AACvB"},"metadata":{},"sourceType":"module","externalDependencies":[]}